/*!
 * @synesthesia-project/precise-audio | https://github.com/synesthesia-project/synesthesia/tree/master/precise-audio
 * Content hash: fd18c7bb70003acdafe9
 */!function(t){var e={};function a(n){if(e[n])return e[n].exports;var s=e[n]={i:n,l:!1,exports:{}};return t[n].call(s.exports,s,s.exports,a),s.l=!0,s.exports}a.m=t,a.c=e,a.d=function(t,e,n){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},a.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)a.d(n,s,function(e){return t[e]}.bind(null,s));return n},a.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="",a(a.s=2)}([function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=a(4),s=a(1);function o(t,e){if("full"===e.mode)return Object.assign({mode:"full"},e.playState);if(e.audio.paused)return e.scheduled?{mode:"basic",state:"playing",effectiveStartTimeMillis:1e3*e.scheduled.startTime,stopTime:e.scheduled.startTime+e.audio.duration}:{mode:"basic",state:"paused",positionMillis:1e3*e.audio.currentTime};{const a=1e3*(t.context.currentTime-e.audio.currentTime/e.audio.playbackRate);return{mode:"basic",state:"playing",effectiveStartTimeMillis:a,stopTime:a/1e3+e.audio.duration}}}function r(t,e,a){var n;c(t.tracks);const o=t.currentTrack();if(o&&"ready"===(null===(n=o.data)||void 0===n?void 0:n.state)){i(t,t.context.currentTime+.05,o.data,e)}a||s.prepareUpcomingTracks(t),u(t)}function i(t,e,a,s){var o,i;if("full"===a.mode){const r=t.context.createBufferSource();if(r.playbackRate.value=t.playbackRate,1!==t.playbackRate&&t.adjustPitchWithPlaybackRate){const e=n(t.context);e.connect(t.gainNode),e.transpose=12*Math.log2(1/t.playbackRate),r.connect(e)}else r.connect(t.gainNode);r.buffer=a.buffer;const d={paddingStartSeconds:0,paddingEndSeconds:0};if((null===(i=null===(o=a.meta)||void 0===o?void 0:o.vbrInfo)||void 0===i?void 0:i.numberOfFrames)&&a.meta.lameInfo){const t=a.meta.samplesPerFrame*a.meta.vbrInfo.numberOfFrames,e=t-a.meta.lameInfo.paddingStart-a.meta.lameInfo.paddingEnd,n=1/a.meta.sampleRate*a.meta.lameInfo.paddingStart,s=1/a.meta.sampleRate*a.meta.lameInfo.paddingEnd;a.buffer.length===e?console.log("Loaded track already gapless"):a.buffer.length===t?(d.paddingStartSeconds=n,d.paddingEndSeconds=s,console.log("Adjusting for gapless playback")):a.buffer.length===t+1152?(d.paddingStartSeconds=n+1/a.meta.sampleRate*576,d.paddingEndSeconds=s+1/a.meta.sampleRate*576,console.log("Adjusting for gapless playback, with additional 1152 samples")):console.log("Mismatch between gapless metadata and loaded audio, full:",t,"real:",e,"decoded:",a.buffer.length)}else console.log("Unable to get gapless metadata from track",a.meta);const c=e+(a.buffer.duration-d.paddingStartSeconds-d.paddingEndSeconds-s/1e3)/t.playbackRate;r.start(e,s/1e3+d.paddingStartSeconds),a.playState={state:"playing",suppressEndedEvent:!1,source:r,effectiveStartTimeMillis:1e3*e-s/t.playbackRate,stopTime:c},r.addEventListener("ended",function(t,e){return()=>{var a,n;const s=t.currentTrack();"ready"===(null===(n=null===(a=s)||void 0===a?void 0:a.data)||void 0===n?void 0:n.state)&&"full"===s.data.mode&&s.data.playState===e&&("playing"!==e.state||e.suppressEndedEvent||(1===t.tracks.length?(s.data.playState={state:"paused",positionMillis:0},t.sendEvent("ended")):(t.tracks=t.tracks.slice(1),t.sendEvent("next"))))}}(t,a.playState))}else{const n=e-s/1e3,o=t.context.currentTime,i=()=>{a.scheduled=void 0;const e=t.context.currentTime;a.suppressEndedEvent=void 0,a.audio.playbackRate=t.playbackRate,a.audio.currentTime=Math.max(0,e-n),a.audio.play()};if(n<=o)i();else{const t=1e3*(n-o);a.scheduled={timeout:setTimeout(i,t),startTime:n}}a.audio.onended=function(t,e){return()=>{var a,n;const s=t.currentTrack();"ready"===(null===(n=null===(a=s)||void 0===a?void 0:a.data)||void 0===n?void 0:n.state)&&s.data===e&&(e.suppressEndedEvent||(1===t.tracks.length?(s.data.audio.currentTime=0,t.sendEvent("ended")):(t.tracks=t.tracks.slice(1),r(t,0),t.sendEvent("next"))))}}(t,a)}}function d(t){if(t.playOnLoad)return t.playOnLoad.promise;{let e=null;const a=new Promise(t=>{e=t});return e&&(t.playOnLoad={callback:e,promise:a}),a}}function c(t,e=0){var a,n;for(let s=0;s<t.length;s++){const o=t[s];console.log(null===(a=o.data)||void 0===a?void 0:a.state),"ready"===(null===(n=o.data)||void 0===n?void 0:n.state)&&(console.log("ready!!!"),"full"===o.data.mode&&"playing"===o.data.playState.state?(o.data.playState.suppressEndedEvent=!0,o.data.playState.source.stop(),o.data.playState={state:"paused",positionMillis:0===s?e:0}):"basic"===o.data.mode&&(o.data.audio.paused?o.data.scheduled&&(clearTimeout(o.data.scheduled.timeout),o.data.scheduled=void 0):(o.data.suppressEndedEvent=!0,o.data.audio.pause(),o.data.audio.currentTime=0===s?e/1e3:0)))}}function u(t){null!==t.animationFrameRequest&&cancelAnimationFrame(t.animationFrameRequest),t.animationFrameRequest=requestAnimationFrame(()=>(function(t){var e,a;t.sendEvent("timeupdate");const n=t.currentTrack();"ready"===(null===(a=null===(e=n)||void 0===e?void 0:e.data)||void 0===a?void 0:a.state)&&"playing"===o(t,n.data).state&&u(t)})(t))}e.getPlayState=o,e.playCurrentTrackFrom=r,e.playTrack=i,e.skip=function(t,e){var a,n,i,u;if(e<1)throw new Error("Invalid number of tracks to skip: "+e);const l=t.currentTrack();let h=!1;if(l){const f=!!("ready"===(null===(a=l.data)||void 0===a?void 0:a.state)&&"playing"===o(t,l.data).state||"ready"!==(null===(n=l.data)||void 0===n?void 0:n.state)&&(null===(i=l)||void 0===i?void 0:i.playOnLoad));if(c(t.tracks),e=Math.min(e,t.tracks.length),t.tracks=t.tracks.slice(e),t.tracks.length>0){if(f){const e=t.tracks[0];"ready"===(null===(u=e.data)||void 0===u?void 0:u.state)?r(t,0):d(e)}s.prepareUpcomingTracks(t)}else h=!0}for(let a=0;a<e;a++)t.sendEvent("next");h&&t.sendEvent("ended")},e.playTrackWhenLoaded=d,e.stopAllTracksWithoutEnding=c},function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=a(7),s=a(0);e.prepareUpcomingTracks=function t(e){var a,o,r,i;const d=()=>t(e);let c=!1;const u=e.context.currentTime;let l=null;for(let t=0;t<e.tracks.length;t++){const h=l;l=null;const f=e.tracks[t];(null===(a=f.timeouts)||void 0===a?void 0:a.download)&&(clearTimeout(f.timeouts.download),c=!0),(null===(o=f.timeouts)||void 0===o?void 0:o.decode)&&(clearTimeout(null===(r=f.timeouts)||void 0===r?void 0:r.decode),c=!0),f.timeouts={};const p=0===t?u:null===(i=h)||void 0===i?void 0:i.stopTime;if(void 0===p)continue;const m=p-u,v=0===t||m<e.thresholds.downloadThresholdSeconds,g=0===t||m<e.thresholds.decodeThresholdSeconds;if(!e.paused()){if(!v){const t=m-e.thresholds.downloadThresholdSeconds,a=Math.max(0,1e3*t)+10;f.timeouts.downloadScheduledAt=performance.now()+a,f.timeouts.download=setTimeout(d,a),c=!0}if(!g){const t=m-e.thresholds.decodeThresholdSeconds,a=Math.max(0,1e3*t)+10;f.timeouts.decodeScheduledAt=performance.now()+a,f.timeouts.decode=setTimeout(d,a),c=!0}}if(f.data){if("downloading"===f.data.state)l={mode:"full",stopTime:p+f.data.duration};else if("downloaded"===f.data.state){if(l={mode:"full",stopTime:p+f.data.duration},g){const t=f.data.bytes,a=f.data.meta;f.data={state:"decoding",duration:f.data.duration,meta:a},c=!0,e.context.decodeAudioData(t).then(t=>{f.data={state:"ready",mode:"full",buffer:t,meta:a,playState:{state:"paused",positionMillis:0}},e.sendEvent("trackstateupdate"),e.tracks[0]===f&&(e.sendEvent("loadeddata"),e.sendEvent("canplay"),e.sendEvent("canplaythrough"),e.sendEvent("timeupdate")),d()}).catch(t=>{f.data={state:"error",error:t},e.dispatchError(t),e.sendEvent("trackstateupdate")})}}else if("ready"===f.data.state){"paused"===s.getPlayState(e,f.data).state&&(0===t&&f.playOnLoad&&(s.playCurrentTrackFrom(e,0,!0),e.sendEvent("play"),f.playOnLoad.callback(),f.playOnLoad=void 0),t>0&&h&&"full"===h.mode&&s.playTrack(e,h.stopTime,f.data,0));const a=s.getPlayState(e,f.data);"playing"===a.state&&(l=a)}}else if(v){f.data={state:"preparing-download"},c=!0,new Promise((t,a)=>{const n=new Audio,s="string"==typeof f.source?f.source:URL.createObjectURL(f.source);n.src=s,n.addEventListener("loadedmetadata",()=>{const a=n.duration,o=e.thresholds.basicModeThresholdSeconds;if("always"===o||"never"!==o&&o<a){e.context.createMediaElementSource(n).connect(e.gainNode),t({mode:"basic",audio:n})}else n.src="","string"!=typeof f.source&&URL.revokeObjectURL(s),t({mode:"full",duration:a})}),n.addEventListener("error",t=>{"string"!=typeof f.source&&URL.revokeObjectURL(s),a(t.error)})}).then(t=>{if("basic"!==t.mode){const{duration:a}=t;let s;return s="string"==typeof f.source?fetch(f.source).then(t=>t.blob()):Promise.resolve(f.source),f.data={state:"downloading",duration:a},e.sendEvent("trackstateupdate"),s.then(t=>new Promise((e,a)=>{const n=new FileReader;n.onload=t=>{var a;e(null===(a=t.target)||void 0===a?void 0:a.result)},n.onerror=()=>{n.abort(),a(n.error)},n.readAsArrayBuffer(t)}).then(t=>{f.data={state:"downloaded",duration:a,bytes:t,meta:n.default(t)},e.sendEvent("trackstateupdate"),d()}))}f.data={state:"ready",mode:"basic",audio:t.audio},e.sendEvent("trackstateupdate"),d()}).catch(t=>{f.data={state:"error",error:t},e.dispatchError(t),e.sendEvent("trackstateupdate")})}}c&&e.sendEvent("trackstateupdate")}},function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=a(3);window.PreciseAudio=n.default},function(t,e,a){"use strict";var n=this&&this.__awaiter||function(t,e,a,n){return new(a||(a=Promise))((function(s,o){function r(t){try{d(n.next(t))}catch(t){o(t)}}function i(t){try{d(n.throw(t))}catch(t){o(t)}}function d(t){var e;t.done?s(t.value):(e=t.value,e instanceof a?e:new a((function(t){t(e)}))).then(r,i)}d((n=n.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0});const s=a(0),o=a(1),r=a(8);class i extends Event{constructor(t,e){super(t),this._target=e}get target(){return this._target}get currentTarget(){return this._target}}e.PreciseAudioEvent=i;class d extends EventTarget{constructor(){super(...arguments),this.state=new r.State(t=>{const e=new i(t,this);this.dispatchEvent(e)},t=>{const e=new ErrorEvent("error",{error:t});this.dispatchEvent(e)})}getAudioNodes(){return{context:this.state.context,input:this.state.gainNode,output:this.state.context.destination}}updateTracks(...t){var e;const[a,...n]=t,o=this.state.currentTrack();a&&(null===(e=o)||void 0===e?void 0:e.source)===a||(s.stopAllTracksWithoutEnding(this.state.tracks),this.state.playbackRate=this.state.defaultPlaybackRate,this.state.tracks=[],a&&this.state.tracks.push({source:a})),this.updateUpcomingTracks(...n)}updateUpcomingTracks(...t){let e;for(e=0;e<t.length&&e<this.state.tracks.length-1&&this.state.tracks[e+1].source===t[e];e++);const a=this.state.tracks.splice(e+1,this.state.tracks.length-e-1,...t.slice(e).map(t=>({source:t})));s.stopAllTracksWithoutEnding(a),o.prepareUpcomingTracks(this.state)}tracks(){return this.state.tracks.map(t=>t.source)}trackStates(){return this.state.tracks.map(t=>{var e,a;const n=t.source;return t.data?"downloaded"===t.data.state&&(null===(a=t.timeouts)||void 0===a?void 0:a.decodeScheduledAt)?{src:n,state:"decoding-scheduled",decodingAt:t.timeouts.decodeScheduledAt}:"ready"===t.data.state?{src:n,state:"ready",mode:t.data.mode}:"error"===t.data.state?{src:n,state:"error",error:t.data.error}:{src:n,state:t.data.state}:(null===(e=t.timeouts)||void 0===e?void 0:e.downloadScheduledAt)?{src:n,state:"download-scheduled",downloadingAt:t.timeouts.downloadScheduledAt}:{src:n,state:"none"}})}get thresholds(){return this.state.thresholds}updateGain(){this.state.gainNode.gain.value=this.state.volume.muted?0:this.state.volume.volume}get volume(){return this.state.volume.volume}set volume(t){const e=Math.max(0,Math.min(1,t));e!==this.state.volume.volume&&(this.state.volume.volume=e,this.updateGain(),this.state.sendEvent("volumechange"))}get muted(){return this.state.volume.muted}set muted(t){t!==this.state.volume.muted&&(this.state.volume.muted=t,this.updateGain(),this.state.sendEvent("volumechange"))}get src(){var t;const e=this.state.currentTrack();return"string"==typeof(null===(t=e)||void 0===t?void 0:t.source)&&e.source||""}set src(t){this.updateTracks(t)}play(t){var e;return n(this,void 0,void 0,(function*(){"suspended"===this.state.context.state&&this.state.context.resume();const a=this.state.currentTrack();if(a){if("ready"!==(null===(e=a.data)||void 0===e?void 0:e.state))return s.playTrackWhenLoaded(a);{const e=s.getPlayState(this.state,a.data);"paused"===e.state&&(s.playCurrentTrackFrom(this.state,e.positionMillis),t||this.state.sendEvent("play"))}}}))}pause(t){var e,a;"suspended"===this.state.context.state&&this.state.context.resume();const n=this.state.currentTrack();if("ready"===(null===(a=null===(e=n)||void 0===e?void 0:e.data)||void 0===a?void 0:a.state)){const e=s.getPlayState(this.state,n.data);if("playing"===e.state){const a=(1e3*this.state.context.currentTime-e.effectiveStartTimeMillis)*this.state.playbackRate;s.stopAllTracksWithoutEnding(this.state.tracks,a),t||this.state.sendEvent("pause")}}o.prepareUpcomingTracks(this.state)}skip(t=1){s.skip(this.state,t)}get paused(){return this.state.paused()}get currentTimeMillis(){var t,e;const a=this.state.currentTrack();if("ready"===(null===(e=null===(t=a)||void 0===t?void 0:t.data)||void 0===e?void 0:e.state)){const t=s.getPlayState(this.state,a.data);if("paused"===t.state)return t.positionMillis;return(1e3*this.state.context.currentTime-t.effectiveStartTimeMillis)*this.state.playbackRate}return 0}get currentTime(){return this.currentTimeMillis/1e3}set currentTime(t){var e,a;const n=this.state.currentTrack();if("ready"===(null===(a=null===(e=n)||void 0===e?void 0:e.data)||void 0===a?void 0:a.state)){const e=1e3*t;"paused"===s.getPlayState(this.state,n.data).state?("basic"===n.data.mode?n.data.audio.currentTime=e/1e3:n.data.playState={state:"paused",positionMillis:e},this.state.sendEvent("timeupdate")):s.playCurrentTrackFrom(this.state,e),this.state.sendEvent("seeked")}}changeConfiguration(t){let e=!1;this.paused||(this.pause(!0),e=!0),t(),e&&this.play(!0)}set adjustPitchWithPlaybackRate(t){this.changeConfiguration(()=>{this.state.adjustPitchWithPlaybackRate=t})}get adjustPitchWithPlaybackRate(){return this.state.adjustPitchWithPlaybackRate}set playbackRate(t){this.changeConfiguration(()=>{this.state.playbackRate=t}),this.state.sendEvent("ratechange")}get playbackRate(){return this.state.playbackRate}set defaultPlaybackRate(t){this.state.defaultPlaybackRate=t}get defaultPlaybackRate(){return this.state.playbackRate}get duration(){var t,e;const a=this.state.currentTrack();return"ready"===(null===(e=null===(t=a)||void 0===t?void 0:t.data)||void 0===e?void 0:e.state)?"basic"===a.data.mode?a.data.audio.duration:a.data.buffer.duration:0}get durationMillis(){return 1e3*this.duration}setSinkId(t){return n(this,void 0,void 0,(function*(){console.error("setSinkId() not implemented in PreciseAudio: "+t)}))}addEventListener(t,e){super.addEventListener(t,e)}removeEventListener(t,e){super.removeEventListener(t,e)}}e.default=d},function(t,e,a){var n=a(5);function s(t){if(t<0)return t/12;return.02278153473118749+.23005591195033048*t+-.014147877819596033*(t*t)+.0009795096626987743*(t*t*t)+-19413043101157434e-21*(t*t*t*t)+1.8149080040913423e-7*(t*t*t*t*t)}function o(t,e,a,n){for(var s=e*t.sampleRate,o=s+(e-2*a)*t.sampleRate,r=t.createBuffer(1,o,t.sampleRate),i=r.getChannelData(0),d=0;d<s;++d)i[d]=n?(s-d)/o:d/s;for(d=s;d<o;++d)i[d]=0;return r}t.exports=function(t){var e=new c(t),a=t.createGain(),o=t.createGain(),r=t.createGain(),i=t.createGain();r.gain.value=0,a.connect(o),a.connect(r),o.connect(e.input),e.output.connect(i),r.connect(i);var d=n(a,i,{dry:{min:0,defaultValue:0,target:r.gain},wet:{min:0,defaultValue:1,target:o.gain}});e.setPitchOffset(s(12));var u=0;return Object.defineProperty(d,"transpose",{set:function(t){u=s(t),e.setPitchOffset(u)},get:function(){return u}}),d};var r=.1,i=.05,d=.1;function c(t){this.context=t;var e=t.createGain(),a=t.createGain();this.input=e,this.output=a;var n=t.createBufferSource(),s=t.createBufferSource(),c=t.createBufferSource(),u=t.createBufferSource();this.shiftDownBuffer=o(t,d,i,!1),this.shiftUpBuffer=o(t,d,i,!0),n.buffer=this.shiftDownBuffer,s.buffer=this.shiftDownBuffer,c.buffer=this.shiftUpBuffer,u.buffer=this.shiftUpBuffer,n.loop=!0,s.loop=!0,c.loop=!0,u.loop=!0;var l=t.createGain(),h=t.createGain(),f=t.createGain();f.gain.value=0;var p=t.createGain();p.gain.value=0,n.connect(l),s.connect(h),c.connect(f),u.connect(p);var m=t.createGain(),v=t.createGain(),g=t.createDelay(),y=t.createDelay();l.connect(m),h.connect(v),f.connect(m),p.connect(v),m.connect(g.delayTime),v.connect(y.delayTime);var T=t.createBufferSource(),k=t.createBufferSource(),b=function(t,e,a){for(var n=e*t.sampleRate,s=n+(e-2*a)*t.sampleRate,o=t.createBuffer(1,s,t.sampleRate),r=o.getChannelData(0),i=a*t.sampleRate,d=i,c=n-i,u=0;u<n;++u){var l;l=u<d?Math.sqrt(u/i):u>=c?Math.sqrt(1-(u-c)/i):1,r[u]=l}for(u=n;u<s;++u)r[u]=0;return o}(t,d,i);T.buffer=b,k.buffer=b,T.loop=!0,k.loop=!0;var S=t.createGain(),E=t.createGain();S.gain.value=0,E.gain.value=0,T.connect(S.gain),k.connect(E.gain),e.connect(g),e.connect(y),g.connect(S),y.connect(E),S.connect(a),E.connect(a);var _=t.currentTime+.05,P=_+d-i;n.start(_),s.start(P),c.start(_),u.start(P),T.start(_),k.start(P),this.mod1=n,this.mod2=s,this.mod1Gain=l,this.mod2Gain=h,this.mod3Gain=f,this.mod4Gain=p,this.modGain1=m,this.modGain2=v,this.fade1=T,this.fade2=k,this.mix1=S,this.mix2=E,this.delay1=g,this.delay2=y,this.setDelay(r)}c.prototype.setDelay=function(t){this.modGain1.gain.setTargetAtTime(.5*t,0,.01),this.modGain2.gain.setTargetAtTime(.5*t,0,.01)},c.prototype.setPitchOffset=function(t){t>0?(this.mod1Gain.gain.value=0,this.mod2Gain.gain.value=0,this.mod3Gain.gain.value=1,this.mod4Gain.gain.value=1):(this.mod1Gain.gain.value=1,this.mod2Gain.gain.value=1,this.mod3Gain.gain.value=0,this.mod4Gain.gain.value=0),this.setDelay(r*Math.abs(t))}},function(t,e,a){var n=a(6);function s(t,e){this._targetCount+=1,this._output.connect(t,e),"function"==typeof this._onDestinationChange&&this._onDestinationChange(this._targetCount)}function o(t){this._targetCount=0,this._output.disconnect(t),"function"==typeof this._onDestinationChange&&this._onDestinationChange(this._targetCount)}t.exports=function(t,e,a,r){var i=(t||e).context.createGain();return i._onDestinationChange=r,t&&i.connect(t),i._output=e,i._targetCount=0,e&&(i.connect=s,i.disconnect=o),function(t,e){if(e)for(var a=Object.keys(e),s=0,o=a.length;s<o;s++){var r=a[s];t[r]=n(t.context,r,e[r])}}(i,a),i},t.exports.createAudioParam=n},function(t,e){function a(t){return null!=this.min&&(t=Math.max(this.min,t)),null!=this.max&&(t=Math.min(this.max,t)),t}function n(t,e){var a=this._targets;t=this.fence(t),this._lastValue=t;for(var n=0,s=a.length;n<s;n++)a[n].setValueAtTime(t,e)}function s(t,e,a){var n=this._targets;t=this.fence(t);for(var s=0,o=n.length;s<o;s++)n[s].setTargetAtTime&&n[s].setTargetAtTime(t,e,a)}function o(t,e){var a=this._targets;t=this.fence(t),this._lastValue=t;for(var n=0,s=a.length;n<s;n++)a[n].linearRampToValueAtTime(t,e)}function r(t,e){var a=this._targets;t=this.fence(t),this._lastValue=t;for(var n=0,s=a.length;n<s;n++)a[n].exponentialRampToValueAtTime(t,e)}function i(t,e,a){var n=this._targets;this._lastValue=t[t.length-1];for(var s=0,o=n.length;s<o;s++)n[s].setValueCurveAtTime(t,e,a)}function d(t){for(var e=this._targets,a=0,n=e.length;a<n;a++)e[a].cancelScheduledValues(t)}function c(){this._targets=[]}function u(t){this._targets.push(t),null!=this._lastValue&&(t.value=this._lastValue)}t.exports=function(t,e,l){var h=(l=l||{}).targets;!h&&l.target?h=[l.target]:h||(h=[]);var f=Object.create(AudioParam.prototype,{value:{get:function(){return f._lastValue},set:function(t){t=f.fence(t),f._lastValue=t;for(var e=0,a=h.length;e<a;e++){h[e].value=t}}},defaultValue:{get:function(){return l.defaultValue}},name:{value:e,writable:!1},min:{value:l.min,writable:!1},max:{value:l.max,writable:!1}});return f._targets=h,f._lastValue=l.defaultValue,f.setValueAtTime=n,f.linearRampToValueAtTime=o,f.exponentialRampToValueAtTime=r,f.setTargetAtTime=s,f.setValueCurveAtTime=i,f.cancelScheduledValues=d,f.addTarget=u,f.clearTargets=c,f.context=t,f.fence=a,null!=l.defaultValue&&(f.value=l.defaultValue),f}},function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n={0:"2.5",2:"2",3:"1"},s={1:"3",2:"2",3:"1"},o=["stereo","joint_stereo","dual_channel","mono"],r={1:[44100,48e3,32e3],2:[22050,24e3,16e3],2.5:[11025,12e3,8e3]},i={"MPEG-1-Layer-1":[0,32,64,96,128,160,192,224,256,288,320,352,384,416,448],"MPEG-1-Layer-2":[0,32,48,56,64,80,96,112,128,160,192,224,256,320,384],"MPEG-1-Layer-3":[0,32,40,48,56,64,80,96,112,128,160,192,224,256,320],"MPEG-2-Layer-1":[0,32,48,56,64,80,96,112,128,144,160,176,192,224,256],"MPEG-2-Layer-O":[0,8,16,24,32,40,48,56,64,80,96,112,128,144,160]},d={1:{1:i["MPEG-1-Layer-1"],2:i["MPEG-1-Layer-2"],3:i["MPEG-1-Layer-3"]},2:{1:i["MPEG-2-Layer-1"],2:i["MPEG-2-Layer-O"],3:i["MPEG-2-Layer-O"]},2.5:{1:i["MPEG-2-Layer-1"],2:i["MPEG-2-Layer-O"],3:i["MPEG-2-Layer-O"]}},c={1:{1:384,2:1152,3:1152},2:{1:384,2:1152,3:576},2.5:{1:384,2:1152,3:576}},u={1:{dual:32,mono:17},2:{dual:17,mono:9},2.5:{dual:17,mono:9}};function l(t,e,a){let n="";for(let s=0;s<a;s++){const a=t[e+s];a>31&&a<127&&(n+=String.fromCharCode(a))}return n}function h(t,e){if("ID3"===l(t,e,3)){const a=16==(16&t[e+5]);return 10+(t[e+6]<<21|t[e+7]<<14|t[e+8]<<7|t[e+9])+(a?10:0)}return 0}function f(t){const e=new Uint8Array(t);let a=0,i=0;for(;0!==(i=h(e,a));)a+=i;return console.log("offset:",a),function(t,e){const a=[t[e],t[e+1],t[e+2],t[e+3]],i=a[0]<<3|a[1]>>5,h=a[1]>>3&3,f=a[1]>>1&3,p=a[2]>>4,m=a[2]>>2&3,v=o[a[3]>>6&3];if(2047!==i)return null;if(1===h)return null;if(0===f)return null;if(15===p)return null;if(3===m)return null;const g=n[h],y=s[f],T={version:g,layer:y,bitrate:d[g][y][p],sampleRate:r[g][m],samplesPerFrame:c[g][y],mode:v};let k=null;if("3"===y){const t="mono"===v?v:"dual";k=4+u[g][t]}else console.log("Unable to calculate start of data frame (TODO)");if(null!==k){const a=e+k,n=l(t,a,4);if("Xing"===n||"Info"===n){const e=1==(1&t[a+7]),s=2==(2&t[a+7]),o=4==(4&t[a+7]),r=8==(8&t[a+7]);let i;const d=a+8;e&&(i=(t[d]<<24)+(t[d+1]<<16)+(t[d+2]<<8)+t[d+3]),T.vbrInfo={isCBR:"Info"===n,numberOfFrames:i};const c=a+8+(e?4:0)+(s?4:0)+(o?100:0)+(r?4:0),u=l(t,c,9);if(9===u.length){const e=t[c+21]<<4|t[c+22]>>4,a=(15&t[c+22])<<8|t[c+23];T.lameInfo={encoder:u,paddingStart:e,paddingEnd:a}}}}return T}(e,a)}e.getMetadata=f,e.default=f},function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=a(9),s=a(0);e.State=class{constructor(t,e){this.animationFrameRequest=null,this.playbackRate=1,this.defaultPlaybackRate=1,this.adjustPitchWithPlaybackRate=!0,this.volume={volume:1,muted:!1},this.tracks=[],this.thresholds=new n.Thresholds,this.context=new AudioContext,this.gainNode=this.context.createGain(),this.gainNode.connect(this.context.destination),this.sendEvent=t,this.dispatchError=e}currentTrack(){return this.tracks[0]}paused(){var t,e;const a=this.currentTrack();return"ready"!==(null===(e=null===(t=a)||void 0===t?void 0:t.data)||void 0===e?void 0:e.state)||"paused"===s.getPlayState(this,a.data).state}}},function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.Thresholds=class{constructor(){this._basicModeThresholdSeconds="never",this._downloadThresholdSeconds=10,this._decodeThresholdSeconds=2}get basicModeThresholdSeconds(){return this._basicModeThresholdSeconds}set basicModeThresholdSeconds(t){if("always"===t||"never"===t)this._basicModeThresholdSeconds=t;else{if("number"!=typeof t)throw new Error(`Invalid value for basicModeThresholdSeconds: ${t}`);this._basicModeThresholdSeconds=t<=0?"never":t}}get downloadThresholdSeconds(){return this._downloadThresholdSeconds}set downloadThresholdSeconds(t){if("number"!=typeof t)throw new Error(`Invalid value for downloadThresholdSeconds: ${t}`);this._downloadThresholdSeconds=Math.max(0,t)}get decodeThresholdSeconds(){return this._decodeThresholdSeconds}set decodeThresholdSeconds(t){if("number"!=typeof t)throw new Error(`Invalid value for decodeThresholdSeconds: ${t}`);this._decodeThresholdSeconds=Math.max(0,t)}}}]);
//# sourceMappingURL=dist.min.js.map